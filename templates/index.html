<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MultiAgent AI | Autonomous Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600&family=Oswald:wght@300;400;500&display=swap");

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-track {
        background: #0a0a0a;
      }
      ::-webkit-scrollbar-thumb {
        background: #333;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #9d1a10;
      }

      /* Animations */
      .reveal-text {
        animation: revealUp 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        opacity: 0;
        transform: translateY(40px);
      }
      .delay-100 {
        animation-delay: 0.1s;
      }
      .delay-200 {
        animation-delay: 0.2s;
      }
      .delay-300 {
        animation-delay: 0.3s;
      }

      @keyframes revealUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .glow-red {
        background: radial-gradient(
          circle at center,
          rgba(157, 26, 16, 0.4) 0%,
          rgba(157, 26, 16, 0) 70%
        );
      }

      body {
        font-family: "Manrope", sans-serif;
      }
      h1,
      h2,
      h3,
      .display-font {
        font-family: "Oswald", sans-serif;
      }

      /* Agent Node Styles */
      .agent-node {
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        transform-origin: center center;
      }
      .agent-node:hover {
        transform: translate(-50%, -50%) scale(1.08);
      }

      /* Colores específicos por agente - Estados Activos */
      #node-manager.active {
        border-color: #3b82f6 !important;
        box-shadow: 0 0 40px rgba(59, 130, 246, 0.6),
          0 0 80px rgba(59, 130, 246, 0.3) !important;
        background: linear-gradient(
          135deg,
          rgba(59, 130, 246, 0.15),
          rgba(59, 130, 246, 0.05)
        ) !important;
        transform: translate(-50%, -50%) scale(1.1) !important;
      }
      #node-investigator.active {
        border-color: #ef4444 !important;
        box-shadow: 0 0 40px rgba(239, 68, 68, 0.6),
          0 0 80px rgba(239, 68, 68, 0.3) !important;
        background: linear-gradient(
          135deg,
          rgba(239, 68, 68, 0.15),
          rgba(239, 68, 68, 0.05)
        ) !important;
        transform: translate(-50%, -50%) scale(1.1) !important;
      }
      #node-analyst.active {
        border-color: #10b981 !important;
        box-shadow: 0 0 40px rgba(16, 185, 129, 0.6),
          0 0 80px rgba(16, 185, 129, 0.3) !important;
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.15),
          rgba(16, 185, 129, 0.05)
        ) !important;
        transform: translate(-50%, -50%) scale(1.1) !important;
      }
      #node-writer.active {
        border-color: #f97316 !important;
        box-shadow: 0 0 40px rgba(249, 115, 22, 0.6),
          0 0 80px rgba(249, 115, 22, 0.3) !important;
        background: linear-gradient(
          135deg,
          rgba(249, 115, 22, 0.15),
          rgba(249, 115, 22, 0.05)
        ) !important;
        transform: translate(-50%, -50%) scale(1.1) !important;
      }

      .agent-node.active .iconify {
        animation: iconPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        transform: scale(1.1);
      }

      .agent-node.active .status-indicator {
        opacity: 1 !important;
        animation: statusPulse 1.5s ease-in-out infinite;
      }

      @keyframes iconPulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1.1);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.25);
        }
      }

      @keyframes statusPulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.3);
          opacity: 0.6;
        }
      }

      /* Connection Lines */
      .connection-line {
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        stroke: #666666; /* Gris más claro y visible */
        stroke-width: 0.3; /* Grosor visible en viewBox 100x100 */
        opacity: 0.8; /* Más visible */
        fill: none;
        stroke-linecap: round;
        stroke-linejoin: round;
        filter: url(#glow);
      }

      /* Refuerzo de visibilidad específico para Analyst → Writer */
      #line-analyst-writer {
        stroke: #dcdcdc;
        stroke-width: 0.9;
        opacity: 1;
        filter: url(#glow) drop-shadow(0 0 3px rgba(255, 255, 255, 0.35));
      }

      /* Animación de flujo direccional (A -> B) */
      .connection-line.active {
        stroke: #ffd700 !important;
        stroke-width: 0.4 !important;
        opacity: 1 !important;
        filter: drop-shadow(0 0 3px rgba(255, 215, 0, 0.8)) !important;
        stroke-dasharray: 4 2 !important;
        animation: flowDirection 1.5s linear infinite;
      }

      /* Estado completado - línea coloreada permanente */
      .connection-line.completed {
        stroke: #10b981 !important;
        stroke-width: 0.35 !important;
        opacity: 1 !important;
        filter: drop-shadow(0 0 2px rgba(16, 185, 129, 0.6)) !important;
        stroke-dasharray: none !important;
      }

      /* Estado fallido - línea opaca */
      .connection-line.failed {
        stroke: rgba(212, 175, 55, 0.4) !important;
        stroke-width: 0.25 !important;
        opacity: 0.5 !important;
        filter: none !important;
        stroke-dasharray: none !important;
      }

      @keyframes flowDirection {
        to {
          stroke-dashoffset: -6;
        }
      }

      /* Terminal Logs */
      .log-entry {
        border-left: 3px solid #333;
        padding: 8px 12px;
        margin-bottom: 0.5rem;
        opacity: 0;
        animation: slideIn 0.3s forwards;
        border-radius: 4px;
        background: rgba(255, 255, 255, 0.02);
        backdrop-filter: blur(10px);
        transition: all 0.2s ease;
        cursor: pointer;
        user-select: none;
      }
      .log-entry:hover {
        background: rgba(255, 255, 255, 0.05);
        transform: translateX(4px);
      }
      .log-entry.expandable::after {
        content: "▼";
        float: right;
        font-size: 10px;
        opacity: 0.5;
        transition: transform 0.2s ease;
      }
      .log-entry.expandable.expanded::after {
        transform: rotate(180deg);
      }
      .log-details {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
        margin-top: 8px;
        padding: 0;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 11px;
        line-height: 1.6;
        color: #a0a0a0;
      }
      .log-details.expanded {
        max-height: 500px;
        padding-top: 8px;
        overflow-y: auto;
      }
      .log-details pre {
        background: rgba(0, 0, 0, 0.3);
        padding: 8px;
        border-radius: 4px;
        overflow-x: auto;
        margin: 4px 0;
      }
      .log-entry.info {
        border-color: #3b82f6;
        background: rgba(59, 130, 246, 0.05);
      }
      .log-entry.success {
        border-color: #10b981;
        background: rgba(16, 185, 129, 0.05);
      }
      .log-entry.warning {
        border-color: #f59e0b;
        background: rgba(245, 158, 11, 0.05);
      }
      .log-entry.error {
        border-color: #ef4444;
        background: rgba(239, 68, 68, 0.05);
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-10px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
    </style>
  </head>
  <body
    class="bg-[#050505] text-neutral-300 antialiased selection:bg-[#9D1A10] selection:text-white overflow-x-hidden"
  >
    <!-- Navigation -->
    <nav
      class="fixed top-0 w-full z-50 px-6 py-6 flex justify-between items-center mix-blend-difference text-white"
    >
      <a
        href="#"
        class="text-3xl tracking-tighter font-semibold uppercase display-font"
      >
        MULTIAGENT<span class="text-[#9D1A10]">.</span>AI
      </a>
      <div
        class="hidden md:flex gap-12 text-sm font-medium tracking-wide uppercase"
      >
        <a
          href="#mission-control"
          class="hover:text-neutral-400 transition-colors"
          >Mission Control</a
        >
        <a href="#live-ops" class="hover:text-neutral-400 transition-colors"
          >Live Ops</a
        >
        <a href="#intelligence" class="hover:text-neutral-400 transition-colors"
          >Intelligence</a
        >
      </div>
      <div class="flex items-center gap-4">
        <div
          id="connectionStatus"
          class="w-2 h-2 rounded-full bg-red-500 animate-pulse"
        ></div>
        <span class="text-xs uppercase tracking-widest text-neutral-500"
          >System Status</span
        >
      </div>
    </nav>

    <!-- Hero Section -->
    <header
      class="relative w-full h-screen flex flex-col justify-center overflow-hidden"
    >
      <div class="absolute inset-0 z-0">
        <!-- Abstract Tech Background -->
        <img
          src="{{ url_for('static', filename='imagen_background.png') }}"
          alt="AI Robots Meeting"
          class="w-full h-full object-cover opacity-30 scale-105 animate-[pulse_10s_ease-in-out_infinite]"
        />
        <div
          class="absolute inset-0 bg-gradient-to-t from-[#050505] via-[#050505]/60 to-transparent"
        ></div>
        <div
          class="absolute inset-0 bg-gradient-to-r from-[#050505] via-transparent to-[#9D1A10]/10 mix-blend-overlay"
        ></div>
      </div>

      <div class="relative z-10 px-6 md:px-12 w-full max-w-7xl mx-auto pt-20">
        <div class="flex flex-col items-start">
          <p
            class="text-[#9D1A10] uppercase tracking-[0.3em] text-xs font-semibold mb-4 reveal-text delay-100"
          >
            Autonomous Swarm Intelligence
          </p>
          <h1
            class="text-6xl md:text-8xl lg:text-9xl font-normal uppercase tracking-tighter leading-[0.85] text-white mix-blend-lighten reveal-text delay-200"
          >
            Orchestrating<br />
            <span class="ml-12 md:ml-24 text-neutral-500">Digital</span> Minds
          </h1>

          <div
            class="mt-12 md:ml-auto md:w-1/3 reveal-text delay-300 backdrop-blur-sm bg-white/5 p-6 border-l-2 border-[#9D1A10]"
          >
            <p
              class="text-sm md:text-base text-neutral-300 font-light leading-relaxed"
            >
              Deploy a coordinated team of AI agents to investigate, analyze,
              and generate high-value intelligence reports in real-time.
            </p>
          </div>

          <div
            class="mt-6 md:ml-auto md:w-1/3 reveal-text delay-400 backdrop-blur-sm bg-white/5 p-6 border-l-2 border-[#9D1A10]"
          >
            <p class="text-xs uppercase tracking-[0.3em] text-[#9D1A10] mb-3">
              Task Force
            </p>
            <ul
              class="space-y-2 text-sm md:text-base text-neutral-200 font-medium"
            >
              <li class="flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-[#9D1A10]"></span>
                Manager — Mission Orchestrator
              </li>
              <li class="flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-[#9D1A10]"></span>
                Investigator — Field Research Lead
              </li>
              <li class="flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-[#9D1A10]"></span>
                Analyst — Bias & Fact Checker
              </li>
              <li class="flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-[#9D1A10]"></span>
                Writer — Senior Narrative Architect
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div
        class="absolute bottom-28 left-6 md:left-12 z-20 reveal-text delay-300"
      >
        <span
          class="text-[#9D1A10] text-xs uppercase tracking-widest font-semibold block mb-2"
        >
          MEMBERS
        </span>
        <div
          class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-2 text-neutral-300 text-sm font-light tracking-wide uppercase"
        >
          <span>Alfonte Tarqui Rendo</span>
          <span>Cuyo Zamata Yimmy Yeyson</span>
          <span>Mamani Zapana Edward</span>
          <span>Turpo Quispe Patty Milagros</span>
        </div>
      </div>

      <div
        class="absolute bottom-10 left-6 md:left-12 z-20 flex items-center gap-4 reveal-text delay-300"
      >
        <div class="h-[1px] w-12 bg-neutral-600"></div>
        <span class="uppercase text-xs tracking-widest text-neutral-500"
          >Scroll to Initialize</span
        >
      </div>
    </header>

    <!-- Mission Control (Input) -->
    <section
      id="mission-control"
      class="relative py-24 px-6 md:px-12 bg-[#0a0a0a] border-t border-white/5"
    >
      <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-12 gap-12 items-center">
          <div class="md:col-span-5">
            <h2
              class="text-4xl md:text-5xl font-light tracking-tight text-white leading-[1.1] mb-6"
            >
              Initialize <span class="text-[#9D1A10]">Mission</span>
            </h2>
            <p class="text-neutral-400 font-light mb-8">
              Define the objective for the agent swarm. The Manager will
              allocate tasks to the Investigator, Analyst, and Writer.
            </p>
          </div>
          <div class="md:col-span-7">
            <div class="flex flex-col gap-4">
              <div class="relative group">
                <input
                  type="text"
                  id="topicInput"
                  class="w-full bg-[#111] border border-white/10 p-6 text-xl text-white placeholder-neutral-600 focus:outline-none focus:border-[#9D1A10] transition-colors"
                  placeholder="Enter research topic (e.g., 'Quantum Computing Breakthroughs')"
                  onkeypress="if(event.key==='Enter') startGeneration()"
                />
                <div
                  class="absolute bottom-0 left-0 h-[1px] w-0 bg-[#9D1A10] transition-all duration-500 group-hover:w-full"
                ></div>
              </div>
              <button
                id="generateBtn"
                onclick="startGeneration()"
                class="self-start group flex items-center gap-4 uppercase text-sm tracking-widest bg-white text-black px-8 py-4 hover:bg-[#9D1A10] hover:text-white transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
              >
                Deploy Agents
                <span
                  class="iconify group-hover:translate-x-1 transition-transform"
                  data-icon="lucide:arrow-right"
                ></span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Live Operations (Visualization) -->
    <section
      id="live-ops"
      class="relative w-full min-h-screen bg-[#050505] border-t border-white/5 flex flex-col md:flex-row"
    >
      <!-- Canvas Area -->
      <div
        class="relative w-full md:w-2/3 h-[80vh] md:h-auto bg-[#080808] overflow-hidden"
        style="
          background-image: radial-gradient(
              circle at 50% 50%,
              rgba(157, 26, 16, 0.05) 0%,
              transparent 50%
            ),
            repeating-linear-gradient(
              0deg,
              rgba(255, 255, 255, 0.02) 0px,
              transparent 1px,
              transparent 40px
            ),
            repeating-linear-gradient(
              90deg,
              rgba(255, 255, 255, 0.02) 0px,
              transparent 1px,
              transparent 40px
            );
        "
      >
        <div class="absolute top-6 left-6 z-10">
          <span
            class="text-[#9D1A10] text-xs uppercase tracking-widest font-semibold"
            >⚡ Live Operations Map</span
          >
        </div>

        <!-- SVG Connections -->
        <svg
          class="absolute inset-0 w-full h-full pointer-events-none z-0"
          viewBox="0 0 100 100"
          preserveAspectRatio="none"
        >
          <defs>
            <!-- Filtro de blur para las líneas -->
            <filter id="glow">
              <feGaussianBlur stdDeviation="0.5" result="coloredBlur" />
              <feMerge>
                <feMergeNode in="coloredBlur" />
                <feMergeNode in="SourceGraphic" />
              </feMerge>
            </filter>
          </defs>

          <!-- 1. Manager → Investigator - Delegación inicial -->
          <path
            id="line-manager-investigator"
            class="connection-line"
            d="M 15 50 L 30 50 L 30 20 L 50 20"
          />

          <!-- 2. Investigator → Analyst - Entrega de hallazgos -->
          <path
            id="line-investigator-analyst"
            class="connection-line"
            d="M 50 20 L 50 50"
          />

          <!-- 3. Analyst → Investigator - Backtracking si rechaza (punteada) -->
          <path
            id="path-backtracking"
            class="connection-line"
            d="M 50 50 L 70 50 L 70 20 L 50 20"
            style="stroke-dasharray: 2, 1; opacity: 0.5"
          />

          <!-- 4. Analyst → Writer - Si aprueba, pasa al Writer -->
          <path
            id="line-analyst-writer"
            class="connection-line"
            d="M 50 50 L 50 80"
            vector-effect="non-scaling-stroke"
          />

          <!-- 5. Writer → Manager - Retorno con artículo completado -->
          <path
            id="line-writer-manager"
            class="connection-line"
            d="M 50 80 L 30 80 L 30 50 L 15 50"
          />
        </svg>

        <!-- Nodes -->
        <!-- Manager (Azul) -->
        <div
          id="node-manager"
          class="agent-node absolute top-1/2 left-[15%] -translate-x-1/2 -translate-y-1/2 w-28 h-28 md:w-32 md:h-32 lg:w-40 lg:h-40 rounded-2xl bg-gradient-to-br from-[#0a0a0a] to-[#111] border-2 border-blue-500/30 flex flex-col items-center justify-center z-10 cursor-pointer group shadow-lg shadow-blue-500/10 backdrop-blur-sm"
          style="transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1)"
        >
          <!-- Puertos de Conexión -->
          <div
            class="absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-blue-400/50 border border-blue-300"
          ></div>
          <div
            class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-blue-400/50 border border-blue-300"
          ></div>
          <div
            class="absolute -left-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-blue-400/50 border border-blue-300"
          ></div>
          <div
            class="absolute -right-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-blue-400/50 border border-blue-300"
          ></div>

          <!-- Indicador de Estado Pulsante -->
          <div
            class="absolute -top-2 -right-2 w-4 h-4 rounded-full bg-blue-500 border-2 border-[#080808] opacity-0 transition-opacity status-indicator"
            style="box-shadow: 0 0 10px rgba(59, 130, 246, 0.8)"
          ></div>

          <span
            class="iconify text-4xl text-blue-400 mb-3 transition-all duration-300"
            data-icon="lucide:briefcase"
            style="filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3))"
          ></span>
          <span
            class="text-xs uppercase tracking-widest text-blue-300 font-semibold"
            >Manager</span
          >
          <span
            class="agent-status text-[10px] text-blue-400 mt-2 opacity-70 font-mono"
            >STANDBY</span
          >
        </div>

        <!-- Investigator (Rojo) -->
        <div
          id="node-investigator"
          class="agent-node absolute top-[20%] left-1/2 -translate-x-1/2 -translate-y-1/2 w-28 h-28 md:w-32 md:h-32 lg:w-40 lg:h-40 rounded-2xl bg-gradient-to-br from-[#0a0a0a] to-[#111] border-2 border-red-500/30 flex flex-col items-center justify-center z-10 cursor-pointer group shadow-lg shadow-red-500/10 backdrop-blur-sm"
          style="transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1)"
        >
          <!-- Puertos de Conexión -->
          <div
            class="absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-red-400/50 border border-red-300"
          ></div>
          <div
            class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-red-400/50 border border-red-300"
          ></div>
          <div
            class="absolute -left-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-red-400/50 border border-red-300"
          ></div>
          <div
            class="absolute -right-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-red-400/50 border border-red-300"
          ></div>

          <!-- Indicador de Estado Pulsante -->
          <div
            class="absolute -top-2 -right-2 w-4 h-4 rounded-full bg-red-500 border-2 border-[#080808] opacity-0 transition-opacity status-indicator"
            style="box-shadow: 0 0 10px rgba(239, 68, 68, 0.8)"
          ></div>

          <span
            class="iconify text-4xl text-red-400 mb-3 transition-all duration-300"
            data-icon="lucide:search"
            style="filter: drop-shadow(0 0 8px rgba(239, 68, 68, 0.3))"
          ></span>
          <span
            class="text-xs uppercase tracking-widest text-red-300 font-semibold"
            >Investigator</span
          >
          <span
            class="agent-status text-[10px] text-red-400 mt-2 opacity-70 font-mono"
            >STANDBY</span
          >
        </div>

        <!-- Analyst (Verde) -->
        <div
          id="node-analyst"
          class="agent-node absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-28 h-28 md:w-32 md:h-32 lg:w-40 lg:h-40 rounded-2xl bg-gradient-to-br from-[#0a0a0a] to-[#111] border-2 border-green-500/30 flex flex-col items-center justify-center z-10 cursor-pointer group shadow-lg shadow-green-500/10 backdrop-blur-sm"
          style="transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1)"
        >
          <!-- Puertos de Conexión -->
          <div
            class="absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-green-400/50 border border-green-300"
          ></div>
          <div
            class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-green-400/50 border border-green-300"
          ></div>
          <div
            class="absolute -left-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-green-400/50 border border-green-300"
          ></div>
          <div
            class="absolute -right-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-green-400/50 border border-green-300"
          ></div>

          <!-- Indicador de Estado Pulsante -->
          <div
            class="absolute -top-2 -right-2 w-4 h-4 rounded-full bg-green-500 border-2 border-[#080808] opacity-0 transition-opacity status-indicator"
            style="box-shadow: 0 0 10px rgba(16, 185, 129, 0.8)"
          ></div>

          <span
            class="iconify text-4xl text-green-400 mb-3 transition-all duration-300"
            data-icon="lucide:brain-circuit"
            style="filter: drop-shadow(0 0 8px rgba(16, 185, 129, 0.3))"
          ></span>
          <span
            class="text-xs uppercase tracking-widest text-green-300 font-semibold"
            >Analyst</span
          >
          <span
            class="agent-status text-[10px] text-green-400 mt-2 opacity-70 font-mono"
            >STANDBY</span
          >
        </div>

        <!-- Writer (Naranja) -->
        <div
          id="node-writer"
          class="agent-node absolute top-[80%] left-1/2 -translate-x-1/2 -translate-y-1/2 w-28 h-28 md:w-32 md:h-32 lg:w-40 lg:h-40 rounded-2xl bg-gradient-to-br from-[#0a0a0a] to-[#111] border-2 border-orange-500/30 flex flex-col items-center justify-center z-10 cursor-pointer group shadow-lg shadow-orange-500/10 backdrop-blur-sm"
          style="transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1)"
        >
          <!-- Puertos de Conexión -->
          <div
            class="absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-orange-400/50 border border-orange-300"
          ></div>
          <div
            class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-orange-400/50 border border-orange-300"
          ></div>
          <div
            class="absolute -left-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-orange-400/50 border border-orange-300"
          ></div>
          <div
            class="absolute -right-1 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-orange-400/50 border border-orange-300"
          ></div>

          <!-- Indicador de Estado Pulsante -->
          <div
            class="absolute -top-2 -right-2 w-4 h-4 rounded-full bg-orange-500 border-2 border-[#080808] opacity-0 transition-opacity status-indicator"
            style="box-shadow: 0 0 10px rgba(249, 115, 22, 0.8)"
          ></div>

          <span
            class="iconify text-4xl text-orange-400 mb-3 transition-all duration-300"
            data-icon="lucide:pen-tool"
            style="filter: drop-shadow(0 0 8px rgba(249, 115, 22, 0.3))"
          ></span>
          <span
            class="text-xs uppercase tracking-widest text-orange-300 font-semibold"
            >Writer</span
          >
          <span
            class="agent-status text-[10px] text-orange-400 mt-2 opacity-70 font-mono"
            >STANDBY</span
          >
        </div>
      </div>

      <!-- Terminal / Logs -->
      <div
        class="w-full md:w-1/3 h-[50vh] md:h-auto bg-[#0a0a0a] border-l border-white/5 flex flex-col"
      >
        <div
          class="p-6 border-b border-white/5 flex justify-between items-center bg-gradient-to-r from-[#0a0a0a] to-[#0d0d0d]"
        >
          <div class="flex items-center gap-3">
            <span
              class="iconify text-emerald-400"
              data-icon="lucide:terminal"
            ></span>
            <span
              class="text-white uppercase tracking-widest text-xs font-semibold"
              >System Logs</span
            >
          </div>
          <div class="flex gap-2">
            <div
              class="w-2.5 h-2.5 rounded-full bg-red-500 shadow-lg shadow-red-500/50"
            ></div>
            <div
              class="w-2.5 h-2.5 rounded-full bg-yellow-500 shadow-lg shadow-yellow-500/50"
            ></div>
            <div
              class="w-2.5 h-2.5 rounded-full bg-green-500 shadow-lg shadow-green-500/50 animate-pulse"
            ></div>
          </div>
        </div>
        <div
          id="logsContainer"
          class="flex-1 p-6 overflow-y-auto font-mono text-xs text-neutral-400 space-y-2"
          style="
            background: linear-gradient(to bottom, #0a0a0a 0%, #080808 100%);
          "
        >
          <div
            class="log-entry info"
            style="
              border-left: 3px solid #3b82f6;
              padding-left: 12px;
              background: rgba(59, 130, 246, 0.05);
              padding: 8px 12px;
              border-radius: 4px;
            "
          >
            <span class="text-blue-400 font-bold">[SYSTEM]</span>
            <span class="text-neutral-300">Ready for initialization...</span>
            <span class="text-neutral-600 text-[10px] ml-2">⏱ Ready</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Intelligence Report (Results) -->
    <section
      id="intelligence"
      class="py-32 bg-white text-black relative hidden"
    >
      <div
        class="absolute top-0 right-0 w-1/2 h-full bg-neutral-100 -skew-x-12 translate-x-32 hidden md:block z-0"
      ></div>

      <div class="relative z-10 px-6 md:px-12 max-w-5xl mx-auto">
        <div class="mb-12">
          <span
            class="text-[#9D1A10] uppercase tracking-widest text-sm font-bold"
            >Mission Complete</span
          >
          <h2
            class="text-5xl md:text-7xl font-normal uppercase tracking-tighter mt-4 text-neutral-900"
          >
            Intelligence <br /><span class="italic font-serif text-[#9D1A10]"
              >Report</span
            >
          </h2>
        </div>

        <div
          id="resultArticle"
          class="prose prose-lg max-w-none prose-headings:font-oswald prose-headings:uppercase prose-p:font-manrope prose-p:font-light prose-a:text-[#9D1A10]"
        >
          <!-- Content will be injected here -->
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer
      class="bg-[#050505] py-12 px-6 md:px-12 border-t border-white/5 relative"
    >
      <div class="max-w-7xl mx-auto flex justify-between items-end">
        <div>
          <p class="text-neutral-600 text-xs uppercase tracking-widest">
            © 2026 MultiAgent AI
          </p>
        </div>
        <div class="text-right">
          <div class="text-4xl font-bold text-white/10 display-font">MA.AI</div>
        </div>
      </div>
    </footer>

    <!-- Logic -->
    <script>
      // =====================================================================
      // GLOBAL VARIABLES
      // =====================================================================
      let socket = null;
      let currentSessionId = null;
      let isGenerating = false;
      let previousAgent = "manager";

      const agentMap = {
        "Investigador de Noticias": "investigator",
        "Analista de Sesgos y Fact-Checker": "analyst",
        "Redactor Senior": "writer",
        "Jefe de Redacción": "manager",
      };

      // =====================================================================
      // INITIALIZATION
      // =====================================================================
      document.addEventListener("DOMContentLoaded", () => {
        initializeSocketIO();
      });

      // =====================================================================
      // SOCKET.IO
      // =====================================================================
      function initializeSocketIO() {
        socket = io("http://localhost:8080/agents", {
          transports: ["websocket", "polling"],
        });

        socket.on("connect", () => {
          addLog("success", "SYSTEM", "Connected to Neural Core");
          const status = document.getElementById("connectionStatus");
          status.classList.remove("bg-red-500");
          status.classList.add("bg-green-500");
        });

        socket.on("disconnect", () => {
          addLog("error", "SYSTEM", "Connection Lost");
          const status = document.getElementById("connectionStatus");
          status.classList.remove("bg-green-500");
          status.classList.add("bg-red-500");
        });

        // Crew Events
        socket.on("crew_start", handleCrewStart);
        socket.on("agent_start", handleAgentStart);
        socket.on("agent_thinking", handleAgentThinking);
        socket.on("agent_finish", handleAgentFinish);
        socket.on("tool_start", handleToolStart);
        socket.on("tool_end", handleToolEnd);
        socket.on("crew_finish", handleCrewFinish);
        socket.on("error", handleError);
        socket.on("generation_complete", handleGenerationComplete);
        socket.on("backtracking", handleBacktracking);
      }

      // =====================================================================
      // GENERATION LOGIC
      // =====================================================================
      async function startGeneration() {
        const topic = document.getElementById("topicInput").value.trim();

        if (!topic) {
          alert("Please enter a mission topic.");
          return;
        }

        if (isGenerating) {
          alert("Mission already in progress.");
          return;
        }

        // Reset UI
        clearLogs();
        document.getElementById("intelligence").classList.add("hidden");
        resetAgentNodes();

        // Scroll to Live Ops
        document
          .getElementById("live-ops")
          .scrollIntoView({ behavior: "smooth" });

        isGenerating = true;
        const btn = document.getElementById("generateBtn");
        btn.disabled = true;
        btn.innerHTML = `Deploying... <span class="iconify animate-spin" data-icon="lucide:loader-2"></span>`;

        addLog("info", "SYSTEM", `Initializing Mission: "${topic}"`);

        try {
          const response = await fetch("http://localhost:8080/api/generate", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ topic }),
          });

          const data = await response.json();

          if (data.status === "started") {
            currentSessionId = data.session_id;
            socket.emit("join_session", { session_id: currentSessionId });
            addLog("success", "SYSTEM", `Session ID: ${currentSessionId}`);
          } else {
            throw new Error(data.message || "Initialization failed");
          }
        } catch (error) {
          addLog("error", "SYSTEM", `Error: ${error.message}`);
          isGenerating = false;
          btn.disabled = false;
          btn.innerHTML = `Deploy Agents <span class="iconify group-hover:translate-x-1 transition-transform" data-icon="lucide:arrow-right"></span>`;
        }
      }

      // =====================================================================
      // EVENT HANDLERS
      // =====================================================================
      function handleCrewStart(data) {
        addLog("info", "CREW", data.message);
        activateNode("manager");
        previousAgent = "manager";
      }

      function handleAgentStart(data) {
        const agentKey = getAgentKey(data.agent);
        const details = `Agent: ${data.agent}\nTask: ${
          data.task || "Processing assigned objective"
        }\nStatus: Initializing...`;
        addLog("info", data.agent.toUpperCase(), "Activated", details);

        if (previousAgent && previousAgent !== agentKey) {
          activateConnection(previousAgent, agentKey);
        }

        activateNode(agentKey);
        updateAgentStatus(agentKey, "ACTIVE");
        previousAgent = agentKey;
      }

      function handleBacktracking(data) {
        const details = `Reason: ${
          data.reason || "Quality check failed"
        }\nFeedback: ${
          data.feedback || "Requesting additional research"
        }\nAction: Routing back to Investigator`;
        addLog("warning", "ANALYST", data.message, details);
        activateConnection("analyst", "investigator");
        previousAgent = "analyst";
      }

      function handleAgentThinking(data) {
        const agentKey = getAgentKey(data.agent);
        addLog("info", data.agent.toUpperCase(), `Thinking...`);
      }

      function showTimeoutWarning(message) {
        // Crear banner de advertencia si no existe
        let banner = document.getElementById("timeout-warning-banner");
        if (!banner) {
          banner = document.createElement("div");
          banner.id = "timeout-warning-banner";
          banner.style.cssText = `
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 9999;
            max-width: 600px;
            text-align: center;
            font-weight: 600;
            animation: slideDown 0.3s ease-out;
          `;
          document.body.appendChild(banner);
        }

        banner.innerHTML = `
          <div style="font-size: 14px; margin-bottom: 5px;">⚠️ PROBLEMA DE TIMEOUT DETECTADO</div>
          <div style="font-size: 12px; opacity: 0.9;">${message}</div>
          <div style="font-size: 11px; margin-top: 8px; opacity: 0.8;">
            Solo se recibieron APIs globales (snippets). Los scrapers locales (artículos completos) no respondieron a tiempo.
          </div>
        `;

        // Auto-ocultar después de 10 segundos
        setTimeout(() => {
          if (banner) {
            banner.style.animation = "slideUp 0.3s ease-out";
            setTimeout(() => banner.remove(), 300);
          }
        }, 10000);
      }

      function handleAgentFinish(data) {
        const agentKey = getAgentKey(data.agent);
        const details = `Agent: ${data.agent}\nStatus: Completed\nOutput: ${
          data.output || "Task finished successfully"
        }\nDuration: ${data.duration || "N/A"}`;
        addLog("success", data.agent.toUpperCase(), "Task Completed", details);
        deactivateNode(agentKey);
        updateAgentStatus(agentKey, "COMPLETED");

        // Visualizar retorno al Manager cuando el Writer termina
        if (agentKey === "writer") {
          activateConnection("writer", "manager");
        }
      }

      function handleToolStart(data) {
        const agentKey = getAgentKey(data.agent);
        const details = `Tool: ${data.tool_name || "External API"}\nAgent: ${
          data.agent
        }\nInput: ${data.input || "Processing..."}\nStatus: Executing tool...`;
        addLog(
          "warning",
          data.agent.toUpperCase(),
          `Using Tool: ${data.tool_name || "External API"}`,
          details
        );
        // activateConnection(agentKey, "tool"); // Removed as no tool node exists
      }

      function handleToolEnd(data) {
        let message = `Tool Execution Finished`;
        let details = `Tool: ${data.tool_name || "External API"}\n`;

        // Mostrar detalles si hay distribución de fuentes
        if (data.output && data.output.includes("Tier1")) {
          message += ` - ${data.output}`;
          details += `Output Summary: ${data.output}\n`;
        }

        if (data.output) {
          details += `\nFull Output:\n${
            typeof data.output === "string"
              ? data.output
              : JSON.stringify(data.output, null, 2)
          }`;
        }

        addLog("success", data.agent.toUpperCase(), message, details);

        // Mostrar alerta si solo hay APIs globales
        if (data.alert) {
          addLog("error", "⚠️ TIMEOUT ISSUE", data.alert);
          // Mostrar banner de advertencia
          showTimeoutWarning(data.alert);
        }
      }

      function handleCrewFinish(data) {
        addLog("success", "CREW", "Mission Accomplished");
        resetAgentNodes();
      }

      function handleGenerationComplete(data) {
        if (data.status === "success") {
          displayResult(data.article);
          addLog("success", "SYSTEM", "Report Generated");

          // Scroll to results
          setTimeout(() => {
            document
              .getElementById("intelligence")
              .scrollIntoView({ behavior: "smooth" });
          }, 1000);
        } else {
          addLog("error", "SYSTEM", `Error: ${data.error}`);
        }

        isGenerating = false;
        const btn = document.getElementById("generateBtn");
        btn.disabled = false;
        btn.innerHTML = `Deploy Agents <span class="iconify group-hover:translate-x-1 transition-transform" data-icon="lucide:arrow-right"></span>`;
      }

      function handleError(data) {
        addLog("error", data.agent || "SYSTEM", data.error);
      }

      // =====================================================================
      // UI HELPERS
      // =====================================================================
      function addLog(type, agent, message, details = null) {
        const container = document.getElementById("logsContainer");
        const entry = document.createElement("div");
        entry.className = `log-entry ${type}`;
        if (details) entry.classList.add("expandable");

        const timestamp = new Date().toLocaleTimeString("en-US", {
          hour12: false,
        });

        // Colores por tipo de log
        const agentColors = {
          info: "text-blue-400",
          success: "text-green-400",
          warning: "text-yellow-400",
          error: "text-red-400",
        };

        const agentColor = agentColors[type] || "text-white";

        entry.innerHTML = `
                <div class="log-header">
                  <span class="${agentColor} font-bold">[${agent}]</span> 
                  <span class="text-neutral-300">${message}</span>
                  <span class="text-neutral-600 text-[10px] ml-2">⏱ ${timestamp}</span>
                </div>
            `;

        if (details) {
          const detailsDiv = document.createElement("div");
          detailsDiv.className = "log-details";
          detailsDiv.innerHTML = formatDetails(details);
          entry.appendChild(detailsDiv);

          entry.addEventListener("click", () => {
            entry.classList.toggle("expanded");
            detailsDiv.classList.toggle("expanded");
          });
        }

        container.appendChild(entry);
        container.scrollTop = container.scrollHeight;
      }

      function formatDetails(details) {
        if (typeof details === "string") {
          return `<pre>${details}</pre>`;
        }
        if (typeof details === "object") {
          return `<pre>${JSON.stringify(details, null, 2)}</pre>`;
        }
        return details;
      }

      function clearLogs() {
        document.getElementById("logsContainer").innerHTML = "";
      }

      function activateNode(agentKey) {
        const node = document.getElementById(`node-${agentKey}`);
        if (node) node.classList.add("active");
      }

      function deactivateNode(agentKey) {
        const node = document.getElementById(`node-${agentKey}`);
        if (node) node.classList.remove("active");
      }

      function updateAgentStatus(agentKey, status) {
        const node = document.getElementById(`node-${agentKey}`);
        if (node) {
          const statusEl = node.querySelector(".agent-status");
          if (statusEl) {
            statusEl.textContent = status;
            statusEl.classList.remove("opacity-0");
          }
        }
      }

      function resetAgentNodes() {
        document.querySelectorAll(".agent-node").forEach((node) => {
          node.classList.remove("active");
          const statusEl = node.querySelector(".agent-status");
          if (statusEl) {
            statusEl.textContent = "STANDBY";
            statusEl.classList.add("opacity-0");
          }
        });
        // Resetear todas las conexiones
        resetConnections();
      }

      function displayResult(article) {
        const panel = document.getElementById("intelligence");
        const articleEl = document.getElementById("resultArticle");

        // Parser de Markdown mejorado con estructura profesional
        let html = article;

        // 0. NORMALIZAR saltos de línea (corregir Markdown mal formateado)

        // Asegurar espacio ANTES de los headers (si hay texto pegado antes)
        html = html.replace(/([^\n])\s*(#{1,6}\s)/g, "$1\n\n$2");

        // Asegurar espacio DESPUÉS de los headers (sin romper la última letra)
        html = html.replace(/^(#{1,6}\s.+?)\s*$/gm, "$1\n\n");

        // 1. Escapar HTML para seguridad
        html = html
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;");

        // 2. Bloques de código con sintaxis (```lang)
        html = html.replace(
          /```(\w+)?\n([\s\S]+?)```/g,
          '<pre class="bg-neutral-900 text-green-400 p-6 rounded-xl overflow-x-auto my-6 shadow-lg border border-neutral-700"><code class="font-mono text-sm leading-relaxed">$2</code></pre>'
        );

        // 3. Headers con estilos periodísticos
        html = html.replace(
          /^######\s+(.+)$/gm,
          '<h6 class="text-sm font-semibold mt-6 mb-2 text-neutral-700 uppercase tracking-wide">$1</h6>'
        );
        html = html.replace(
          /^#####\s+(.+)$/gm,
          '<h5 class="text-base font-bold mt-6 mb-3 text-neutral-800">$1</h5>'
        );
        html = html.replace(
          /^####\s+(.+)$/gm,
          '<h4 class="text-lg font-bold mt-8 mb-3 text-neutral-800 border-l-4 border-[#9D1A10] pl-3">$1</h4>'
        );
        html = html.replace(
          /^###\s+(.+)$/gm,
          '<h3 class="text-xl md:text-2xl font-bold mt-10 mb-4 text-neutral-900">$1</h3>'
        );
        html = html.replace(
          /^##\s+(.+)$/gm,
          '<h2 class="text-2xl md:text-3xl font-bold mt-12 mb-6 text-neutral-900 border-b-2 border-[#9D1A10] pb-3">$1</h2>'
        );
        html = html.replace(
          /^#\s+(.+)$/gm,
          '<h1 class="text-4xl md:text-5xl lg:text-6xl font-black mb-6 text-[#9D1A10] leading-tight tracking-tight">$1</h1>'
        );

        // 4. Separadores con estilo
        html = html.replace(
          /^---$/gm,
          '<hr class="my-10 border-t-2 border-neutral-200" />'
        );
        html = html.replace(
          /^\*\*\*$/gm,
          '<hr class="my-10 border-t-2 border-dashed border-neutral-300" />'
        );

        // 5. Blockquotes estilo periodístico
        html = html.replace(
          /^&gt;\s+(.+)$/gm,
          '<blockquote class="border-l-4 border-[#9D1A10] bg-neutral-50 pl-6 pr-4 py-4 italic text-lg text-neutral-700 my-6 rounded-r-lg shadow-sm">$1</blockquote>'
        );

        // 6. Listas desordenadas con mejor espaciado
        html = html.replace(
          /^\*\s+(.+)$/gm,
          '<li class="ml-6 list-disc mb-3 text-neutral-700 leading-relaxed">$1</li>'
        );
        html = html.replace(
          /^-\s+(.+)$/gm,
          '<li class="ml-6 list-disc mb-3 text-neutral-700 leading-relaxed">$1</li>'
        );

        // 7. Listas ordenadas
        html = html.replace(
          /^\d+\.\s+(.+)$/gm,
          '<li class="ml-6 list-decimal mb-3 text-neutral-700 leading-relaxed">$1</li>'
        );

        // 8. Agrupar listas en containers
        html = html.replace(
          /(<li class="ml-6 list-disc[^>]*>.*?<\/li>(\n|$))+/gs,
          '<ul class="my-6 space-y-1">$&</ul>'
        );
        html = html.replace(
          /(<li class="ml-6 list-decimal[^>]*>.*?<\/li>(\n|$))+/gs,
          '<ol class="my-6 space-y-1">$&</ol>'
        );

        // 9. Formato inline - bold, italic, combinados
        html = html.replace(
          /\*\*\*(.+?)\*\*\*/g,
          '<strong class="font-black text-neutral-900"><em class="italic">$1</em></strong>'
        );
        html = html.replace(
          /\*\*(.+?)\*\*/g,
          '<strong class="font-bold text-neutral-900">$1</strong>'
        );
        html = html.replace(
          /\*(.+?)\*/g,
          '<em class="italic text-neutral-600">$1</em>'
        );
        html = html.replace(
          /__(.+?)__/g,
          '<strong class="font-bold text-neutral-900">$1</strong>'
        );
        html = html.replace(
          /_(.+?)_/g,
          '<em class="italic text-neutral-600">$1</em>'
        );

        // 10. Links con icono externo
        html = html.replace(
          /\[([^\]]+)\]\(([^)]+)\)/g,
          '<a href="$2" target="_blank" rel="noopener noreferrer" class="text-[#9D1A10] font-medium underline decoration-2 underline-offset-2 hover:text-red-700 hover:decoration-wavy transition-all duration-200">$1 <span class="text-xs">↗</span></a>'
        );

        // 11. Código inline
        html = html.replace(
          /`([^`]+)`/g,
          '<code class="bg-red-50 text-[#9D1A10] px-2 py-0.5 rounded font-mono text-sm border border-red-100">$1</code>'
        );

        // 12. Párrafos bien formateados
        html = html
          .split("\n\n")
          .map((block) => {
            const trimmed = block.trim();

            // No envolver si ya es elemento estructural
            if (trimmed.match(/^<(h[1-6]|ul|ol|pre|blockquote|hr|div)/)) {
              return trimmed;
            }

            // No envolver items de lista sueltos
            if (trimmed.match(/^<li/)) {
              return trimmed;
            }

            // Párrafos vacíos
            if (!trimmed) {
              return "";
            }

            // Párrafo normal con tipografía profesional
            return `<p class="mb-6 text-lg leading-relaxed text-neutral-700 text-justify">${trimmed}</p>`;
          })
          .filter((block) => block) // Remover vacíos
          .join("\n");

        // 13. Detectar y estilizar el lead (primer párrafo en negrita)
        html = html.replace(
          /^<p class="mb-6[^>]*"><strong[^>]*>(.+?)<\/strong><\/p>/m,
          '<p class="mb-8 text-xl md:text-2xl leading-relaxed text-neutral-800 font-semibold border-l-4 border-[#9D1A10] pl-4 bg-neutral-50 py-4 rounded-r">$1</p>'
        );

        // 14. Limpiar saltos de línea excesivos
        html = html.replace(/\n{3,}/g, "\n\n");

        // 15. Wrapper para article con clase profesional
        const styledHtml = `
          <article class="prose prose-lg max-w-none">
            ${html}
          </article>
        `;

        articleEl.innerHTML = styledHtml;
        panel.classList.remove("hidden");

        // Scroll suave al resultado
        setTimeout(() => {
          panel.scrollIntoView({ behavior: "smooth", block: "start" });
        }, 300);
      }

      function getAgentKey(agentName) {
        return agentMap[agentName] || "manager";
      }

      function activateConnection(fromAgent, toAgent, success = true) {
        let connectionId = null;

        // FLUJO PRINCIPAL
        if (fromAgent === "manager" && toAgent === "investigator") {
          connectionId = "line-manager-investigator";
        } else if (fromAgent === "investigator" && toAgent === "analyst") {
          connectionId = "line-investigator-analyst";
        } else if (fromAgent === "analyst" && toAgent === "writer") {
          connectionId = "line-analyst-writer";
        }
        // RETROALIMENTACIÓN (Backtracking)
        else if (fromAgent === "analyst" && toAgent === "investigator") {
          connectionId = "path-backtracking";
        }
        // RETORNO (Writer finaliza y reporta a Manager)
        else if (fromAgent === "writer" && toAgent === "manager") {
          connectionId = "line-writer-manager";
        }

        if (connectionId) {
          const line = document.getElementById(connectionId);
          if (line) {
            // Limpiar estados previos
            line.classList.remove("active", "completed", "failed");

            // Activar animación direccional
            line.classList.add("active");

            // Después de la animación, establecer estado final
            setTimeout(() => {
              line.classList.remove("active");
              if (success) {
                line.classList.add("completed");
              } else {
                line.classList.add("failed");
              }
            }, 2000);
          }
        }
      }

      function resetConnections() {
        const connections = document.querySelectorAll(".connection-line");
        connections.forEach((line) => {
          line.classList.remove("active", "completed", "failed");
        });
      }
    </script>
  </body>
</html>
